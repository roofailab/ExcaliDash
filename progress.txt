2026-02-24: Implemented CLI argument parsing in packages/sync-diagrams/src/index.ts. Uses node:util parseArgs for --dir (default: docs/diagrams) and --config (default: .excalidraw-sync.json). Validates EXCALIDASH_URL and EXCALIDASH_API_KEY env vars, exits 1 with clear error if missing. Exports SyncOptions type + options object for downstream modules. TSC passes.
2026-02-24: Implemented manifest read/write module at packages/sync-diagrams/src/manifest.ts. Types: SyncManifest, DrawingEntry. Exports: readManifest (returns empty manifest on ENOENT), writeManifest (formatted JSON), getDrawingEntry, updateDrawingEntry. TSC passes.
2026-02-24: Implemented Mermaid file discovery/extraction at packages/sync-diagrams/src/mermaid.ts. discoverMermaidFiles (recursive readdirSync, sorted), extractMermaidContent (first # heading as title, first ```mermaid block as code), computeContentHash (sha256:<hex> via node:crypto). TSC passes.
2026-02-24: Implemented ExcaliDash API client at packages/sync-diagrams/src/api.ts. ExcaliDashClient class with getDrawing/createDrawing/updateDrawing using native fetch + X-API-Key header. Non-2xx throws descriptive errors with status. TSC passes. Next: src/convert.ts (Mermaid-to-Excalidraw wrapper).

[2026-02-24] Implement Mermaid-to-Excalidraw conversion wrapper (convert.ts)
- Created packages/sync-diagrams/src/convert.ts
- Added jsdom + @types/jsdom deps to sync-diagrams package.json
- Both @excalidraw/mermaid-to-excalidraw and @excalidraw/excalidraw are browser-only bundles
  (require document/window globals). Used jsdom to shim DOM env before dynamic import.
- @excalidraw/excalidraw's convertToExcalidrawElements is webpack-bundled and can't run in Node.js;
  implemented minimal equivalent (skeletonToElements) that adds required ExcalidrawElement fields
  (seed, version, versionNonce, isDeleted, frameId, boundElements, updated, link, locked, angle).
- getBBox mocked on SVGElement.prototype to read explicit SVG attrs (mermaid sets width/height attrs).
- Tested: flowchart with 4 nodes produces 7 elements with all required keys.
- TypeScript compilation clean.

[2026-02-24] Implement sync-diagrams core logic (index.ts main sync loop)
- Wired all modules (api, manifest, mermaid, convert) into the main sync loop in index.ts.
- Loop: discover *.mermaid.md → hash → skip if unchanged → check ExcaliDash updatedAt (skip if human-edited) → convert → POST/PUT → update manifest → exit 0/1.
- Added files field to CreateDrawingPayload/UpdateDrawingPayload in api.ts (needed for non-native diagram types that render as embedded images).
- Build clean; API key middleware tests (5/5) pass.
- X-API-Key backend middleware was already fully implemented (auth.ts requireAuthOrApiKey/optionalAuthOrApiKey, config.ts API_KEYS + CI_SERVICE_ACCOUNT_EMAIL, .env.example documented). Drawing routes use it correctly.
